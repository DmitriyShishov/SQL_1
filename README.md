## Задание
Требуется написать SQL-запрос собирающий из предоставленных данных таблицу следующего вида:

"time_index, region_name, temp, max_temp, min_temp, gac_cons"

Полученная таблица должна содержать данные по двум регионам: Австрия и Франция. Нужно учесть,
что в исходных данных могут быть пропуски (нужно заполнить пропуски на основе значений за соседние
даты).

## Решение
Q1. Здесь мы получаем значения даты, имени региона (с заглавной буквы), минимальную и максимальную прогнозную температуру на определенную дату. Берем только те строки, в которых указан прогноз (is_fact = False) и регион Франция или Австрия. Здесь необходимо использовать функцию Initcap, так как в таблице есть строки, где название страны прописано заглавными буквами. Группируем агрегирующие функции по дате и названию региона (с заглавной буквы)

Q2. В следующем подзапросе мы выбираем дату и потребление газа в эту дату. Так как регион здесь представлен кодом, с помощью функции case when необходимо переименовать значение региона. Соединяем подзапрос 1 с подзапросом 2 методом left join по условию, чтоб даты и названия регионов были одинаковыми.

Q3. Осталось только добавить информацию о фактической температуре. По аналогии с подзапросом 1 выбираем строки, где указана фактическая температура (is_fact = True) и регион Австрия или Франция. Соединяем результаты подзапросов методом left join для строк с одинаковой датой и регионом.

Q4. В таблице погоды есть 5 дней подряд, для которых фактическая температура отсутствует. Заполним ее в эти дни средним значением за 5 дней до и 5 дней после текущей даты в этом же регионе. Аналогично поступим с таблицей отборов газа для тех дней, которые пропущены в таблице. Также пронумеруем строки, где дата и регион одинаковы.
Далее выбираем те столбцы, которые должны быть представлены в итоговой таблице. Добавляем условие where, которое уберет продублированные строки для даты и региона.
